---
import "@styles/style.css";

import { type Frontmatter } from "@utils/types.ts";
interface Props {
  frontmatter: Frontmatter;
}
const { frontmatter } = Astro.props;

import "@styles/style.css";
import AvatarImage from "@data/images/avatar.png";
import { menuToggleId } from "@utils/consts.ts";

import Meta from "@components/ui/Meta.astro";
import Bar from "@components/ui/Bar.astro";
import Sidebar from "@components/ui/Sidebar.astro";
import SidebarButton from "@components/ui/SidebarButton.astro";
import Avatar from "@components/ui/Avatar.astro";
import IconDisplay from "@components/ui/IconDisplay.astro";
import Nav from "@components/ui/Nav.astro";
import ThemeButton from "@components/ui/ThemeButton.astro";
import Beats from "@components/showoff/Beats.astro";

import {
  internalLinks,
  externalLinks,
  subscribeLinks,
  socialLinks,
  metaLinks,
} from "@data/links";

const hostname = Astro.url.hostname;
const site_name = "gregsite";
const locale = "en_US";
---

<html lang="en">
  <head>
    <Meta frontmatter={frontmatter} site_name={site_name} locale={locale} />
  </head>

  <body>
    <Bar type="header">
      <Avatar slot="left" image={AvatarImage} />
      <h2 slot="left" style="padding-left: 0.5rem">{hostname}</h2>
      <ThemeButton slot="right" />
      <SidebarButton slot="right" id={menuToggleId} />
    </Bar>

    <div class="spacer">
      <main>
        <slot />
      </main>
      <aside>
        <Sidebar id={menuToggleId}>
          <Nav slot="top" links={internalLinks} intrasite={true} />
          <Nav slot="top" links={externalLinks} intrasite={false} />
          <Nav slot="top" links={subscribeLinks} intrasite={false} />
          <IconDisplay slot="bottom" links={socialLinks} />
        </Sidebar>
      </aside>
    </div>

    <Bar type="footer">
      <div slot="left" style="height: 2rem;">
        <Beats />
      </div>
    </Bar>
  </body>
</html>

<style>
  body {
    /* grow to end of page */
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    margin: 0;
  }

  main {
    width: 80%;
    max-width: 1200px;
    padding: 2rem;
    margin-left: auto;
    margin-right: auto;

    background: var(--main-bg);
    color: var(--text);
    box-shadow:
      0 0 2px rgba(0, 0, 0, 1),
      2px 4px 5px rgba(0, 0, 0, 0.15);
  }

  aside {
    background: var(--main-bg);
    color: var(--text);
  }

  .spacer {
    flex: 1; /* grow to end of page */
    display: flex;
    flex-direction: row-reverse;
    max-width: 100vw;

    /* left/right are auto
       ensures centering */
    margin: 0 auto 0 auto;
  }

  @media (min-width: 768px) {
    main {
    }
    aside {
      width: 320px;
      height: fit-content;

      margin-right: 2rem;

      box-shadow:
        0 0 2px rgba(0, 0, 0, 1),
        2px 4px 5px rgba(0, 0, 0, 0.15);
    }

    .spacer {
    }
  }
</style>
